## 重点

- Linux的每个文件中，依据权限分为使用者、群组与其他人三种身份；
- 群组最有用的功能之一，就是当你在团队开发资源的时候，且每个账号都可以有多个群组的支持；
- 利用ls -l显示的文件属性中，第一个字段是文件的权限，共有十个位，第一个位是文件类型， 接下来三个为一组共三组，为使用者、群组、其他人的权限，权限有r,w,x三种；
- 如果档名之前多一个『 . 』，则代表这个文件为『隐藏档』；
- 更改文件的群组支持可用chgrp，修改文件的拥有者可用chown，修改文件的权限可用chmod
- chmod修改权限的方法有两种，分别是符号法与数字法，数字法中r,w,x分数为4,2,1；
- 对文件来讲，权限的效能为：
  - r：可读取此一文件的实际内容，如读取文本文件的文字内容等；
  - w：可以编辑、新增或者是修改该文件的内容(但不含删除该文件)；
  - x：该文件具有可以被系统执行的权限。
- 对目录来说，权限的效能为：
  - r (read contents in directory)
  - w (modify contents of directory)
  - x (access directory)
- 要开放目录给任何人浏览时，应该至少也要给予r及x的权限，但w权限不可随便给；
- Linux档名的限制为：单一文件或目录的最大容许文件名为 255 个字符；包含完整路径名称及目录 (/) 之完整档名为 4096 个字符
- 根据FHS的官方文件指出， 他们的主要目的是希望让使用者可以了解到已安装软件通常放置于那个目录下
- FHS订定出来的四种目录特色为：shareable, unshareable, static, variable等四类；
- FHS所定义的三层主目录为：/, /var, /usr三层而已；
- 有五个目录不可与根目录放在不同的partition，分别为/etc, /bin, /lib, /dev, /sbin五个。

## 使用者与群组

----

### 文件拥有者

由于Linux是个多人多任务的系统，因此常常会有多人使用这部主机来进行工作。假如，你有一份秘密文件在主机里，总不希望别人可以看到它里面的内容吧。这个时候，你就把该文件设定成【只有该文件的拥有者，也就是我，才能看到和修改这个文件的内容】，呢么及时其他人知道你有这个文件存在，也无法查看里面的内容。这就是权限！

### 群组概念

那么群组呢？为何配置文件还要有所属的群组呢？其实，群组是最有用的功能之一，就是当你在团队开发资源的时候。假如有两个专题在主机里面，第一个为projecta，成员有class1、class2、class3；第二个为projectb，成员有class4、class5、class6。这两个专题是竞争性质，却要提交同一份报告。每组的组员之间必须能够查看并修改本组专题的数据，但是其他组的组员无法查看我方的数据。此时该怎么办？在LInux下这样的限制简单！

我可以经由简易的文件权限设定，就能限制【非自己团队（亦是群组）的人不能阅览其内容】，同时我还可以将我的私密文件也设定为【除我以外其他人不准查看！】

另外，如果boss账号是这两个专题的负责人，他必须可以看到两个专题的具体进度，以防他们摸鱼。这时你可以设定【boss这个账号同时支持群组projecta和projectb这两个群组！】

> 也就是说每个账号都可以有多个群组的支持！

### 其他人的概念

正好，有个投资商来了，他想了解这个专题方案，考虑是否投资。没错，这个投资商就是【其他人（Others）】！

### Root

但一家公司总该有个CEO，他可以查看公司的大大小小的文件，简直无所不能。这个人在Ｌｉｎｕｘ系统中的身份代号是【root】！

### Linux用户身份与群组记录的文件

在Ｌｉｎｕｘ系统中，默认情况下，所有的系统上的账号与一般身份使用者，还有那个万能的ｒｏｏｔ的相关信息，都是记录在`/etc/passwd`这个文件内的。至于个人密码则是记录在`etc/shadow`这个文件下。此外，Linux所有的组名都记录在`etc/group`内！这三个文件可以说是Linux系统的账号、密码、群组信息的集中地了！不要随便删除这三个文件啊！^ _ ^

## Linux的文件权限概念

----

### Linux文件属性

有个重要的，也是常用的指令必须先说，就是【ls】这个察看文件的指令！在你以【root】的身份登入系统后，下达【ls -al】看看，就会有类似于这个的东东：

![](https://pic3.zhimg.com/80/v2-ed0414a17950c14955563bd77840cbb4_r.jpg)

ls就是【list】的意思，重点在显示文件的文件名与相关属性。而选项【-al】则表示列出所有的文件详细的权限与属性（包括隐藏档，就是文件名第一个字符为【.】的文件）。

我们先解释一下上面七个字段的意思：

- 第一个字段代表文件的类型与权限（permission）仔细看它有十个字符
  
  - 第一个字符代表这个文件的类型
    
    - 当为【 d】则是目录，例如上表中文档名为【.gconf】的那一行
    
    - 当为【 -】则是文件，例如上表中文档名为【install.log】的那一行
    
    - 若为【 l】则表示为连结档（link file）
    
    - 若是【 b】则表示为装置文件里面的可供存储的接口设备（可随机存取装置）
    
    - 若是【 c】则表示为装置文件里面的串行端口装置，例如键盘、鼠标（一次性读取装置）
  
  - 接下来的字符中，以三个为一组，且均为【rwx】的三个参数的组合
    
    - 【r】代表可读【read】
    - 【w】代表可写【write】
    - 【x】代表可执行【execute】
    - 要注意的是，这三个权限的位置不会改变，如果没有权限，就会出现减号【-】而已
  
  - 第一组为【文件拥有者的权限】，以那个【install.log】文件为例，该文件的拥有者只可以读写，不可以执行
  
  - 第二组为【同群组的权限】
  
  - 第三组为【其他人的权限】

> 例题：
> 
> 若有一个文件的类型与权限数据为【-rwxr-xr--】请说明其意义是什么？
> 
> 答：
> 
> 这个文件名为文件，拥有者可读、可写、可执行；同群组用户可读、可执行；其他用户可读。

- 第二个字段表示有多少档名连结到此节点（i-node）：
  每个文件都会将他的权限与属性记录到文件系统的i-node中，不过，我们使用的目录树却使用文件名来记录记录，因此，每个档名就会连结到一个i-node！这个属性记录的，就是有多少个不同的档名连接到相同一个i-node号码。关于i-node的相关数据会之后好好谈谈！
- 第三个字段表示这个文件（或目录）的【拥有着账号】
- 第四个字段表示这个文件的所属群组：
  在Linux系统下，你的账号会附属于一个或多个的群组中，举刚才的例子，class1，class2，class3均属于projecta 这个群组，假设某个文件的权限是【-rwxrwx---】，则class1，class2，class3三人均对于这个文件都可读，可写，可执行（看群组权限），但是不属于这个群组的其他账号就对于此文件不具有任何权限了。
- 第五个字段表示这个文件的容量大小，默认单位是字节（bytes）
- 第六个字段表示这个文件的最近修改日期：
  这一个自负案的内容分别为日期（月、日）及时间。如果文件被修改的时间距离现在太久了，那么时间会仅显示年份而已。
- 第七个字段表示这个档案的档名：
  如果档名之前多一个『 . 』，则代表这个档案为『隐藏档』， 例如上表第 6 行的『.bashrc_history』档名即是隐藏档，由于我们有下一个参数为【 ls -al】，所以连隐藏档都列出来，如果你只输入 【ls】 则档名有加『 . 』的档案就不会被显示出来！

>  假设 test1, test2, test3 同属于 testgroup 这个群组：
> 
> 例题一：如果有下面的两个档案，请说明两个档案的拥有者与其相关的权限为何？ 
> 
> ```shell
> -rw-r--r-- 1 root root 238 Jun 18 17:22 test.txt 
> -rwxr-xr-- 1 test1 testgroup 5238 Jun 19 10:25 ping_tsai
> ```
> 
> 答：
> 
> - 档案『 test.txt 』的拥有人为 root ，群组为 root 。至于权限方面则只有 root 这个账号可以存取此档案，其他人则仅能读此档案；
> 
> - 另一个档案『 ping_tsai 』的拥有人为 test1 ，而群组为 testgroup。其中， test1 可以针对此档案具有可读可写可执行的权力，而同群组的 test2, test3 两个人与 test1 同样是 testgroup 的群组账号，则仅可读可执行但不能写 (亦即不能修改)，至于非 testgoup 这一个群组的人则仅可以读，不能写也不能执行！

> 例题二：如果我的目录为下面的样式，请问 testgroup 这个群组的成员与其他人( others )是否可以进入本目录？
> 
> ```shell
> drwxr-xr--   1 test1    testgroup    5238 Jun 19 10:25 groups/
> ```
> 
> 答：
> 
> - 档案拥有者 test1 可以在本目录中进行任何工作；
> - 而 testgroup 这个群组的账号，例如 test2, test3 亦可以进入本目录进行工作， 但是不能在本目录下进行写入的动作；
> - 至于 other 的权限中虽然有 r ，但是由于没有 x 的权限，因此 others 的使用者，并不能进入此目录！

### Linux 文件属性的重要性

与 Windows 系统不一样的是，在 Linux 系统（或者说 Unix-Like 系统）当中，每一个档案都多加了很多的属性进来，尤其是群组的概念，这样有什么用途呢？ 基本上，最大的用途是在『安全性』上面的。
举个简单的例子，在你的系统中，关于系统服务的档案通常只有 root 才能读写，或者是执行，例如 /etc/shadow 这一个账号管理的档案，由于该档案记录了你的系统中的所有账号的数据，因此是很重要的一个信息文件， 当然不能让任何人读取，只有 root 才能够来读取啰！所以该档案的属性就会成为 [ -rw------- ]啰！  

那么，如果你有一个开发团队，在你的团队中，你希望每个人都可以使用某一些目录下的档案， 而非你的团队的其他人则不予以开放呢？以上面的例子来说，testgroup 的团队共有三个人，分别是 test1, test2, test3 ！那么我就可以将 test1 的文件属性订为 [ -rwxrwx--- ] 来提供给 testgroup 的工作团队使用啰！这可是相当重要的。  

再举个例子来说，如果你的目录权限没有做好的话，可能造成其他人都可以在你的系统上面乱搞啰！例如本来只有 root 才能做的开关机、ADSL 的拨接程序、新增或删除用户等等的指令，若被你改成任何人都可以执行的话， 那么如果使用者不小心给你重新启动啦！重新拨接啦！等等的！那么你的系统不就会常常莫名其妙的挂掉！ 而且万一你的用户的密码被其他不明人士取得的话，只要他登入你的系统就可以轻而易举的执行一些 root 的工作！可怕吧！因此，在你修改你的 linux 档案与目录的属性之前， 一定要先搞清楚，什么是可变的，什么是不可变的！千万要注意！

## 如何改变档案权限

好了，我们已经知道【档案权限】对于一个系统的安全重要性了，也知道档案的权限对于【使用者与群组的相关性】了， 好了，那么【如何修改一个档案的权限】呢？又！有多少档案的权限我们可以修改呢？ 毕竟一个档案的权限很多嘛！大致上我们先介绍几个简单的，例如：群组、拥有者、各种身份的权限等等。

- chgrp ：改变档案所属群组

- chown ：改变档案所属人

- chmod ：改变档案的属性、 SUID 、等等的特性

----

### 改变所属群组-chgrp

改变一个档案的所属群组很简单！这个指令就是【change group】的缩写嘛。不过，请记得要改变的组名必须要在`/etc/group`文件内存在才行，否则就会出现错误！

> 假设您是以 root 的身份登入Linux系统 ，那么在您的家目录内有一个 install.log 的档案， 如何将该档案的群组改变一下呢？
> 
> 假设您已经知道在 /etc/group 里面已经存在一个名为 users 的群组，但是 testing 这个群组名字不存在 /etc/group 当中了， 此时分别改变群组成为 users 与 testing 会有什么现象发生呢？
> 
> ![](https://pic1.zhimg.com/80/v2-102cd68b9f67836a0b195fde6c631d5e_r.jpg)
> 
> 发现了吧~文件的群组被改成users了，但是要改成testing时，就会发生错误。注意！发生错误讯息的内容翻译一下，就知道问题出现在哪里了！

### 改变文件拥有者-chown

改变文件拥有者就是【chage owner】！要注意，用户必须是已经存在系统中的账号，也就是在`/etc/passwd`这个文件中有记录的用户名称才不会报错！

chown还可以顺便修改群组的名称呢，此外，如果要帘幕下的所有此目录或文件同时更改拥有者的话，直接加上【-R】的选项即可！

![](https://pica.zhimg.com/80/v2-53268f81fff8794127b7af9b7477cc18_r.jpg)

**知道怎么改变文件的群组与文件拥有者,那么什么时候要使用chown或chgrp呢？**

或许你觉得有点鸡肋，但是它必然有作用的，最常见的例子就是在复制文件给其他人时，我们使用最简单的cp指令来说明：

```shell
[root@www ~]# cp 来源文件 目标文件
```

假设你今天要将.bashrc这个文件拷贝成为.bashrc_test档名，且是要给bin这个人，你可以这样做：

```shell
[root@www ~]# cp .bashrc .bashrc_test
[root@www ~]# ls -al .bashrc*
-rw-r--r-- 1 root root 395 Jul 4 11:45 .bashrc
-rw-r--r-- 1 root root 395 Jul 13 11:31 .bashrc_test <==新文件的属性没变
```

由于复制行为(cp)会复制执行者的属性与权限，所以！怎么办？.bashrc_test还是属于root所拥有， 如此一来，即使你将文件拿给bin这个使用者了，那他仍然无法修改的(看属性/权限就知道了吧)， 所以你就必须要将这个文件的拥有者与群组修改一下啰！知道如何修改了吧？

### 改变权限-chmod

文件权限的改变使用的就是chmod这个指令，但是权限的设定方法有两种，分别是用数字或符号来进行权限的变更！

-----

- 数字类型变更权限
  Linux文件的基本权限就有9个，分别是owner/group/others三种身份各有自己的read/write/execute权限，先复习一下上面所提到的数据：文件的权限符号为【-rwxrwxrwx】，这九个权限是三个一组的！其中，我们可以使用数字来代表各个权限，各权限的分数对照表如下：
  
  - r：4
  
  - w：2
  
  - x：1
  
  每种身份（owner/group/others）各自的三个权限（r/w/x）分数是需要累加的，例如权限为【-rwxrwx---】分数为：
  
  - owner = rwx=4+2+1=7
  
  - group = rwx=4+2+1=7
  
  - others = ---=0
  
  所以我们设定的权限变更时，该文件的权限数字为770！变更权限的指令chmod的语法为：
  
  ```shell
  [root@www ~]# chmod [-R] xyz 文件或目录
  选项与参数：
  xyz : 就是刚刚提到的数字类型的权限属性，为 rwx 属性数值的相加。
  -R : 进行递归(recursive)的持续变更，亦即连同次目录下的所有文件都会变更
  ```

举例来说，如果要将.bashrc这个文件所有的权限都设定启用，那么就下达：

```shell
[root@www ~]# ls -al .bashrc
-rw-r--r--  1 root root 395 Jul  4 11:45 .bashrc
[root@www ~]# chmod 777 .bashrc
[root@www ~]# ls -al .bashrc
-rwxrwxrwx  1 root root 395 Jul  4 11:45 .bashrc
```

那如果要将权限变成『 -rwxr-xr-- 』呢？那么权限的分数就成为 [4+2+1][4+0+1][4+0+0]=754 啰！所以你需要下达『 chmod 754 filename』。 另外，在实际的系统运作中最常发生的一个问题就是，常常我们以[vim](http://cn.linux.vbird.org/linux_basic/0310vi.php)编辑一个shell的文字批处理文件后，他的权限通常是 `-rw-rw-r--` 也就是`664`， 如果要将该文件变成可执行文件，并且不要让其他人修改此一文件的话， 那么就需要`-rwxr-xr-x`这样的权限，此时就得要下达：『 chmod 755 test.sh 』的指令啰！  

另外，如果有些文件你不希望被其他人看到，那么应该将文件的权限设定为例如：『-rwxr-----』，那就下达『 chmod 740 filename 』吧！

------

- 符号类型改变文件权限

还有一个改变权限的方法呦！从之前的介绍中我们可以发现，基本上就九个权限分别是(1)user (2)group (3)others三种身份啦！那么我们就可以藉由u, g, o来代表三种身份的权限！此外， a 则代表 all 亦即全部的身份！那么读写的权限就可以写成r, w, x！也就是可以使用底下的方式来看：

| chmod | u<br/>g<br/>o<br/>a | +(加入)<br/>-（除去）<br/>=（设定） | r<br/>w<br/>x | 文件或目录 |
|:-----:| ------------------- | ------------------------- | ------------- | ----- |

来实作一下吧！假如我们要『设定』一个文件的权限成为『-rwxr-xr-x』时，基本上就是：  

- user (u)：具有可读、可写、可执行的权限；
- group 与 others (g/o)：具有可读与执行的权限。

所以就是：

```shell
[root@www ~]# chmod  u=rwx,go=rx  .bashrc
# 注意喔！这个 u=rwx,go=rx 是连在一起的，中间并没有任何空格！
[root@www ~]# ls -al .bashrc
-rwxr-xr-x  1 root root 395 Jul  4 11:45 .bashrc
```

那么假如是『 -rwxr-xr-- 』这样的权限呢？可以使用『 chmod u=rwx,g=rx,o=r filename 』来设定。此外，如果我不知道原先的文件属性，而我只想要增加.bashrc这个文件的每个人均可写入的权限， 那么我就可以使用：

```shell
[root@www ~]# ls -al .bashrc
-rwxr-xr-x  1 root root 395 Jul  4 11:45 .bashrc
[root@www ~]# chmod  a+w  .bashrc
[root@www ~]# ls -al .bashrc
-rwxrwxrwx  1 root root 395 Jul  4 11:45 .bashrc
```

而如果是要将权限去掉而不更动其他已存在的权限呢？例如要拿掉全部人的可执行权限，则：

```shell
[root@www ~]# chmod  a-x  .bashrc
[root@www ~]# ls -al .bashrc
-rw-rw-rw-  1 root root 395 Jul  4 11:45 .bashrc
```

知道 +, -, = 的不同点了吗？对啦！ + 与 – 的状态下，只要是没有指定到的项目，则该权限『不会被变动』， 例如上面的例子中，由于仅以 `–` 拿掉 `x` 则其他两个保持当时的值不变！多多实作一下，你就会知道如何改变权限啰！ 这在某些情况底下很好用的～举例来说，你想要教一个朋友如何让一个程序可以拥有执行的权限， 但你又不知道该文件原本的权限为何，此时，利用『chmod a+x filename』 ，就可以让该程序拥有执行的权限了。是否很方便？

------

## 目录与文件之权限意义

现在我们知道了Linux系统内文件的三种身份(拥有者、群组与其他人)，知道每种身份都有三种权限(rwx)， 已知道能够使用chown, chgrp, chmod去修改这些权限与属性，当然，利用ls -l去观察文件也没问题。 前两小节也谈到了这些文件权限对于数据安全的重要性。那么，这些文件权限对于一般文件与目录文件有何不同呢？ 

----

### 权限对文件的重要性

文件是实际含有数据的地方，包括一般文本文件、数据库内容文件、二进制可执行文件(binary program)等等。 因此，权限对于文件来说，他的意义是这样的：

- r (read)：可读取此一文件的实际内容，如读取文本文件的文字内容等；
- w (write)：可以编辑、新增或者是修改该文件的内容(**但不含删除该文件**)；
- x (execute)：该文件具有可以被系统执行的权限。

那个可读(r)代表读取文件内容是还好了解，那么可执行(x)呢？这里你就必须要小心啦！ 因为在Windows底下一个文件是否具有执行的能力是藉由『 扩展名 』来判断的， 例如：.exe, .bat, .com 等等，但是在Linux底下，我们的文件是否能被执行，则是藉由是否具有『x』这个权限来决定的！跟档名是没有绝对的关系的！

至于最后一个w这个权限呢？当你对一个文件具有w权限时，你可以具有写入/编辑/新增/修改文件的内容的权限， 但并不具备有删除该文件本身的权限！对于文件的rwx来说， 主要都是针对**文件的内容**而言，与文件档名的存在与否没有关系喔！因为**文件记录的实际是数据**嘛！

---

### 权限对目录的重要性

文件是存放实际数据的所在，那么目录主要是储存啥玩意啊？目录主要的内容在**记录文件名列表**，文件名与目录有强烈的关联啦！ 所以如果是针对目录时，那个 r, w, x 对目录是什么意义呢？

- r (read contents in directory)：  
  
  表示具有读取目录结构列表的权限，所以当你具有读取(r)一个目录的权限时，表示你可以**查询该目录下的文件名数据**。 所以你就可以利用 ls 这个指令将该目录的内容列表显示出来！  

- w (modify contents of directory)：  
  
  这个可写入的权限对目录来说，是很了不起的！ 因为他表示你具有**异动该目录结构列表**的权限，也就是底下这些权限：  
  
  - 建立新的文件与目录；
  
  - 删除已经存在的文件与目录(**不论该文件的权限为何**)
  
  - 将已存在的文件或目录进行更名；
  
  - 搬移该目录内的文件、目录位置。
  
  总之，目录的w权限就与该目录底下的文件名异动有关就对了啦！  

- x (access directory)：  
  
  咦！目录的执行权限有啥用途啊？目录只是记录文件名而已，总不能拿来执行吧？没错！目录不可以被执行，目录的x代表的是**用户能否进入该目录成为工作目录的用途**！ 所谓的工作目录(work directory)就是你目前所在的目录啦！举例来说，当你登入Linux时， 你所在的家目录就是你当下的工作目录。而变换目录的指令是『`cd`』(change directory)啰！

大致的目录权限概念是这样，底下我们来看几个范例，让你了解一下啥是目录的权限！

> 例题：
> 
> 有个目录的权限如下所示：
> 
> `drwxr--r-- 3 root root 4096 Jun 25 08:35 .ssh`
> 
> 系统有个账号名称为vbird，这个账号并没有支持root群组，请问vbird对这个目录有何权限？是否可切换到此目录中？
> 
> 答：
> 
> vbird对此目录仅具有r的权限，因此vbird可以查询此目录下的文件名列表。因为vbird不具有x的权限， 因此vbird并不能切换到此目录内！(相当重要的概念！)

上面这个例题中因为vbird具有r的权限，因为是r乍看之下好像就具有可以进入此目录的权限，其实那是错的。 能不能进入某一个目录，只与该目录的x权限有关啦！此外， 工作目录对于指令的执行是非常重要的，如果你在某目录下不具有x的权限， 那么你就无法切换到该目录下，也就无法执行该目录下的任何指令，即使你具有该目录的r的权限。

很多人在架设网站的时候都会卡在一些权限的设定上，他们开放目录数据给因特网的任何人来浏览， 却只开放r的权限，如上面的范例所示那样，那样的结果就是导致网站服务器软件无法到该目录下读取文件(最多只能看到档名)， 最终用户总是无法正确的查阅到文件的内容(显示权限不足啊！)。要注意：要开放目录给任何人浏览时，应该至少也要给予r及x的权限，但w权限不可随便给！ 为什么w不能随便给，我们来看下一个例子：

> 例题：
> 
> 假设有个账号名称为dmtsai，他的家目录在`/home/dmtsai/`，dmtsai对此目录具有[rwx]的权限。 若在此目录下有个名为the_root.data的文件，该文件的权限如下：
> 
> `-rwx------ 1 root  root  4365 Sep 19 23:20  the_root.data`
> 
> 请问dmtsai对此文件的权限为何？可否删除此文件？
> 
> 答：
> 
> 如上所示，由于dmtsai对此文件来说是『others』的身份，因此这个文件他无法读、无法编辑也无法执行， 也就是说，他无法变动这个文件的内容就是了。  
> 
> 但是由于**这个文件在他的家目录下**， **他在此目录下具有rwx的完整权限**，因此对于the_root.data这个『档名』来说，他是能够『删除』的！ 结论就是，dmtsai这个用户能够删除the_root.data这个文件！

还是看不太懂？来实战一波：

- 先用root的身份建立所需要的文件与目录环境
  
  我们用root的身份在所有人都可以工作的`/tmp`目录中建立一个名为`testing`的目录， 该目录的权限为`744`且目录拥有者为`root`。另外，在`testing`目录下在建立一个空的文件， 档名亦为`testing`。建立目录可用`mkdir`指令(make directory)，建立空文件可用【touch】（后面会讲）来处理。 所以过程如下所示：

```shell
[root@www ~]# cd /tmp                     <==切换工作目录到/tmp
[root@www tmp]# mkdir testing             <==建立新目录
[root@www tmp]# chmod 744 testing         <==变更权限
[root@www tmp]# touch testing/testing     <==建立空的文件
[root@www tmp]# chmod 600 testing/testing <==变更权限
[root@www tmp]# ls -ald testing testing/testing
drwxr--r-- 2 root root 4096 Sep 19 16:01 testing
-rw------- 1 root root    0 Sep 19 16:01 testing/testing
# 仔细看一下，目录的权限是 744 ，且所属群组与使用者均是 root 喔！
# 那么在这样的情况底下，一般身份用户对这个目录/文件的权限为何？
```

- 一般用户的读写权限为何？观察中
  
  在上面的例子中，虽然目录是744的权限设定，一般用户应该能有 r 的权限， 但这样的权限使用者能做啥事呢？假设系统中含有一个账号名为 `vbird` 的， 我们可以透过『 `su - vbird` 』这个指令来变换身份喔！看看底下的操作先！
  
  ```shell
  [root@www tmp]# su - vbird <==切换身份成为 vbird 啰！
  [vbird@www ~]$ cd /tmp     <==看一下，身份变了喔！提示字符也变成 $ 了！
  [vbird@www tmp]$ ls -l testing/
  ?--------- ? ? ? ?             ? testing
  # 因为具有 r 的权限可以查询档名。不过权限不足(没有x)，所以会有一堆问号。
  [vbird@www tmp]$ cd testing/
  -bash: cd: testing/: Permission denied
  # 因为不具有 x ，所以当然没有进入的权限啦！有没有呼应前面的权限说明啊！
  ```

- 如果该目录属于用户本身，会有什么状况？
  
  上面的练习我们知道了只有r确实可以让用户读取目录的文件名列表，不过详细的信息却还是读不到的， 同时也不能将该目录变成工作目录(用 cd 进入该目录之意)。那如果我们让该目录变成用户的， 那么用户在这个目录底下是否能够删除文件呢？底下的练习做看看：
  
  ```shell
  [vbird@www tmp]$ exit               <==让 vbird 变回原本的 root 身份喔！
  [root@www tmp]# chown vbird testing <==修改权限，让vbird拥有此目录
  [root@www tmp]# su - vbird          <==再次变成vbird来操作
  [vbird@www ~]$ cd /tmp/testing      <==可以进入目录了呢！因为owner在自己主目录权限rwx的
  [vbird@www testing]$ ls -l
  -rw------- 1 root root 0 Sep 19 16:01 testing  <==文件不是vbird的！
  [vbird@www testing]$ rm testing     <==尝试刪除这个文件看看！
  rm: remove write-protected regular empty file `testing'? y
  # 竟然可以删除！这样理解了吗？！
  ```

透过上面这个简单的步骤，你就可以清楚的知道， `x` 在目录当中是与『能否进入该目录』有关， 至于那个 `w` 则具有相当重要的权限，因为他可以让使用者删除、更新、新建文件或目录， 是个很重要的参数啊！这样可以理解了吗？！ ^_^

## Linux文件种类与扩展名

一直强调一个概念，那就是：任何装置在Linux底下都是文件， 不仅如此，连数据沟通的接口也有专属的文件在负责～所以，你会了解到，Linux的文件种类真的很多～ 除了前面提到的一般文件(-)与目录文件(d)之外，还有哪些种类的文件呢？

### 文件种类

我们在刚刚提到使用『ls -l』观察到第一栏那十个字符中，第一个字符为文件的类型。 除了常见的一般文件(-)与目录文件(d)之外，还有哪些种类的文件类型呢？

- 正规文件(regular file )：  
  就是一般我们在进行存取的类型的文件，在由 `ls -al` 所显示出来的属性方面，第一个字符为 [ - ]，例如 [-rwxrwxrwx ]。另外，依照文件的内容，又大略可以分为：  
  
  - 纯文本档(ASCII)：这是Linux系统中最多的一种文件类型啰， 称为纯文本档是因为内容为我们人类可以直接读到的数据，例如数字、字母等等。 几乎只要我们可以用来做为设定的文件都属于这一种文件类型。 举例来说，你可以下达『 `cat ~/.bashrc` 』就可以看到该文件的内容。 (cat 是将一个文件内容读出来的指令)  
  
  -  二进制文件(binary)： 我们的系统其实仅认识且可以执行二进制文件(binary file)吧？没错～ 你的Linux当中的可执行文件(scripts, 文字型批处理文件不算)就是这种格式的啦～ 举例来说，刚刚下达的指令`cat`就是一个`binary file`。  
  
  - 数据格式文件(data)： 有些程序在运作的过程当中会读取某些特定格式的文件，那些特定格式的文件可以被称为数据文件 (data file)。举例来说，我们的Linux在使用者登入时，都会将登录的数据记录在 `/var/log/wtmp`那个文件内，该文件是一个`data file`，他能够透过`last`这个指令读出来！ 但是使用`cat`时，会读出乱码～因为他是属于一种特殊格式的文件。懂否？

- 目录(directory)：  
    就是目录啰～第一个属性为 [ d ]，例如 [drwxrwxrwx]

- 连结档(link)：  
  就是类似Windows系统底下的快捷方式啦！ 第一个属性为 【 l 】(英文L的小写)，例如 [lrwxrwxrwx] ；

- 设备与装置文件(device)：  
  与系统周边及储存等相关的一些文件， 通常都集中在/dev这个目录之下！通常又分为两种：  
  
  - 区块(block)设备档 ：就是一些储存数据， 以提供系统随机存取的接口设备，举例来说，硬盘与软盘等就是啦！ 你可以随机的在硬盘的不同区块读写，这种装置就是成组设备啰！你可以自行查一下`/dev/sda`看看， 会发现第一个属性为[ `b` ]喔！  
  - 字符(character)设备文件：亦即是一些串行端口的接口设备， 例如键盘、鼠标等等！这些设备的特色就是『一次性读取』的，不能够截断输出。 举例来说，你不可能让鼠标『跳到』另一个画面，而是『滑动』到另一个地方啊！第一个属性为 [ `c` ]。

- 数据接口文件(sockets)：  
  既然被称为数据接口文件， 想当然，这种类型的文件通常被用在网络上的数据承接了。我们可以启动一个程序来监听客户端的要求， 而客户端就可以透过这个socket来进行数据的沟通了。第一个属性为 [ `s` ]， 最常在`/var/run`这个目录中看到这种文件类型了。  

- 数据输送文件(FIFO, pipe)：  
  FIFO也是一种特殊的文件类型，他主要的目的在解决多个程序同时存取一个文件所造成的错误问题。 FIFO是`first-in-first-out`的缩写。第一个属性为[`p`] 。

> 除了设备文件是我们系统中很重要的文件，最好不要随意修改之外(通常他也不会让你修改的啦！)， 另一个比较有趣的文件就是连结档。如果你常常将应用程序捉到桌面来的话，你就应该知道在 Windows底下有所谓的『快捷方式』。同样的，你可以将 linux下的连结档简单的视为一个文件或目录的快捷方式。 至于socket与FIFO文件比较难理解，因为这两个咚咚与程序(process)比较有关系， 这个等到未来你了解process之后，再回来查阅吧！此外， 你也可以透过man fifo及man socket来查阅系统上的说明！

### Linux文件扩展名

基本上，Linux的文件是没有所谓的『扩展名』的，我们刚刚就谈过，一个Linux文件能不能被执行，与他的第一栏的十个属性有关， 与档名根本一点关系也没有。这个观念跟Windows的情况不相同喔！在Windows底下， 能被执行的文件扩展名通常是 .com .exe .bat等等，而在Linux底下，只要你的权限当中具有x的话，例如[ -rwx-r-xr-x ] 即代表这个文件可以被执行！

不过，可以被执行跟**可以执行成功**是不一样的～举例来说，在root家目录下的install.log 是一个纯文本档，如果经由修改权限成为 -rwxrwxrwx 后，这个文件能够真的执行成功吗？ 当然不行～因为他的内容根本就没有可以执行的数据。所以说，这个x代表这个文件具有可执行的能力， 但是能不能执行成功，当然就得要看该文件的内容啰～

虽然如此，不过我们仍然希望可以藉由扩展名来了解该文件是什么东西，所以， 通常我们还是会以适当的扩展名来表示该文件是什么种类的。底下有数种常用的扩展名：

- *.sh ： 脚本或批处理文件 (scripts)，因为批处理文件为使用shell写成的，所以扩展名就编成 .sh ；  

- *Z, *.tar, *.tar.gz, *.zip, *.tgz： 经过打包的压缩文件。这是因为压缩软件分别为 gunzip, tar 等等的，由于不同的压缩软件，而取其相关的扩展名啰！  

- *.html, *.php：网页相关文件，分别代表 HTML 语法与 PHP 语法的网页文件啰！ .html 的文件可使用网页浏览器来直接开启，至于 .php 的文件， 则可以透过 client 端的浏览器来 server 端浏览，以得到运算后的网页结果呢！

基本上，Linux系统上的文件名真的只是让你了解该文件可能的用途而已， 真正的执行与否仍然需要权限的规范才行！例如虽然有一个文件为可执行文件， 如常见的/bin/ls这个显示文件属性的指令，不过，如果这个文件的权限被修改成无法执行时， 那么ls就变成不能执行！

上述的这种问题最常发生在文件传送的过程中。例如你在网络上下载一个可执行文件，但是偏偏在你的 Linux系统中就是无法执行！呵呵！那么可能文件的属性被改变了！不要怀疑，从网络上传送到你的 Linux系统中，文件的属性与权限确实是会被改变的喔！

### Linux文件长度限制

在Linux底下，使用预设的Ext2/Ext3文件系统时，针对文件的档名长度限制为：

- 单一文件或目录的最大容许文件名为 255 个字符；
- 包含完整路径名称及目录 (/) 之完整档名为 4096 个字符。

是相当长的档名喔！我们希望Linux的文件名可以一看就知道该文件在干嘛的， 所以档名通常是很长很长！而用惯了Windows的人可能会受不了，因为文件名通常真的都很长， 对于用惯Windows而导致打字速度不快的朋友来说，嗯！真的是很困扰.....不过，只得劝你好好的加强打字的训练！

而由热键你也会知道， 其实可以透过[tab]按键来确认文件的文件名的！这很好用啊！ 当然啦，如果你已经读完了关于[BASH]的用法，那么你将会发现 『[哇！变量真是一个相当好用的东西。』 嗯！看不懂，没关系，到谈到bash再说！

### Linux文件名的限制

由于Linux在文字接口下的一些指令操作关系，一般来说，你在设定Linux底下的文件名时， 最好可以避免一些特殊字符比较好！例如底下这些：

> * ? > < ; & ! [ ] | \ ' " ` ( ) { }

因为这些符号在文字接口下，是有特殊意义的！另外，文件名的开头为小数点『.』时， 代表这个文件为『隐藏档』喔！同时，由于指令下达当中，常常会使用到 -option 之类的选项， 所以你最好也避免将文件档名的开头以 - 或 + 来命名啊！

## Linux目录配置

在了解了每个文件的相关种类与属性，以及了解了如何更改文件属性/权限的相关信息后，再来要了解的就是， 为什么每套Linux distributions他们的配置文件啊、执行文件啊、每个目录内放置的咚咚啊，其实都差不多？ 原来是有一套标准依据的！

----

### Linux目录配置的依据--FHS

因为利用Linux来开发产品或distributions的社群/公司与个人实在太多了， 如果每个人都用自己的想法来配置文件放置的目录，那么将可能造成很多管理上的困扰。 你能想象，你进入一个企业之后，所接触到的Linux目录配置方法竟然跟你以前学的完全不同吗？ 很难想象吧～所以，后来就有所谓的Filesystem Hierarchy Standard (FHS)标准的出炉了！

根据FHS([http://www.pathname.com/fhs/](http://www.pathname.com/fhs))的官方文件指出， 他们的主要目的是希望让使用者可以了解到已安装软件通常放置于那个目录下， 所以他们希望独立的软件开发商、操作系统制作者、以及想要维护系统的用户，都能够遵循FHS的标准。 也就是说，FHS的重点在于规范每个特定的目录下应该要放置什么样子的数据而已。 这样做好处非常多，因为Linux操作系统就能够在既有的面貌下(目录架构不变)发展出开发者想要的独特风格。

事实上，FHS是根据过去的经验一直再持续的改版的，FHS依据文件系统使用的频繁与否与是否允许使用者随意更动， 而将目录定义成为四种交互作用的形态，用表格来说有点像底下这样：

|                | 可分享的（shareable）      | 不可分享的（unshareable） |
| -------------- | -------------------- | ------------------ |
| 不可变的（static）   | /user（软件放置处）         | /etc（配置文件）         |
|                | /opt（第三方协力软件）        | /boot（开机与核心档）      |
| 可变动的（variable） | /var/email（使用者邮箱）    | /var/run（程序相关）     |
|                | /var/spool/news（新闻组） | /var/lock（程序相关）    |

- 可分享的：可以分享给其他系统挂载使用的目录，所以包括执行文件与用户的邮件等数据， 是能够分享给网络上其他主机挂载用的目录；  

- 不可分享的：自己机器上面运作的装置文件或者是与程序有关的socket文件等， 由于仅与自身机器有关，所以当然就不适合分享给其他主机了。  

- 不变的：有些数据是不会经常变动的，跟随着distribution而不变动。 例如函式库、文件说明文件、系统管理员所管理的主机服务配置文件等等；  

- 可变动的：经常改变的数据，例如登录文件、一般用户可自行收受的新闻组等。

事实上，FHS针对目录树架构仅定义出三层目录底下应该放置什么数据而已，分别是底下这三个目录的定义：

- / (root, 根目录)：与开机系统有关；
- /usr (unix software resource)：与软件安装/执行有关；
- /var (variable)：与系统运作过程有关。

为什么要定义出这三层目录呢？其实是有意义的喔！每层目录底下所应该要放置的目录也都又特定的规定喔！ 由于我们尚未介绍完整的Linux系统，所以底下的介绍你可能会看不懂！没关系，先有个概念即可。

> **Tips:**  
> 这个 root 在 Linux 里面的意义真的很多很多～多到让人搞不懂那是啥玩意儿。 如果以『账号』的角度来看，所谓的 root 指的是『系统管理员！』的身份， 如果以『目录』的角度来看，所谓的 root 意即指的是根目录，就是 / 啦～ 要特别留意喔！

### 根目录 (/) 的意义与内容

根目录是整个系统最重要的一个目录，因为不但所有的目录都是由根目录衍生出来的， 同时根目录也与开机/还原/系统修复等动作有关。 

> 由于系统开机时需要特定的开机软件、核心文件、开机所需程序、 函式库等等文件数据，若系统出现错误时，根目录也必须要包含有能够修复文件系统的程序才行。 

因为根目录是这么的重要，所以在FHS的要求方面，他希望根目录不要放在非常大的分割槽内， 因为越大的分割槽你会放入越多的数据，如此一来根目录所在分割槽就可能会有较多发生错误的机会。

因此**FHS标准建议**：根目录(/)所在分割槽应该越小越好， 且应用程序所安装的软件最好不要与根目录放在同一个分割槽内，保持根目录越小越好。 如此不但效能较佳，根目录所在的文件系统也较不容易发生问题。

有鉴于上述的说明，因此FHS定义出根目录(/)底下应该要有底下这些次目录的存在才好：

| 目录     | 应放置文件内容                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|:------:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| /bin   | 系统有很多放置执行文件的目录，但/bin比较特殊。因为/bin放置的是在单人维护模式下还能够被操作的指令。 在/bin底下的指令可以被root与一般账号所使用，主要有：cat, chmod, chown, date, mv, mkdir, cp, bash等等常用的指令。                                                                                                                                                                                                                                                                                                                                                                   |
| /boot  | 这个目录主要在放置开机会使用到的文件，包括Linux核心文件以及开机选单与开机所需配置文件等等。 Linux kernel常用的档名为：vmlinuz，如果使用的是grub这个开机管理程序， 则还会存在/boot/grub/这个目录喔！                                                                                                                                                                                                                                                                                                                                                                                     |
| /dev   | 在Linux系统上，任何装置与接口设备都是以文件的型态存在于这个目录当中的。 你只要透过存取这个目录底下的某个文件，就等于存取某个装置啰～ 比要重要的文件有/dev/null, /dev/zero, /dev/tty, /dev/lp*, /dev/hd*, /dev/sd*等等                                                                                                                                                                                                                                                                                                                                                               |
| /etc   | 系统主要的配置文件几乎都放置在这个目录内，例如人员的账号密码文件、 各种服务的启始档等等。一般来说，这个目录下的各文件属性是可以让一般使用者查阅的， 但是只有root有权力修改。FHS建议不要放置可执行文件(binary)在这个目录中喔。比较重要的文件有： /etc/inittab, /etc/init.d/, /etc/modprobe.conf, /etc/X11/, /etc/fstab, /etc/sysconfig/ 等等。另外，其下重要的目录有：<br/>1.`/etc/init.d/`：所有服务的预设启动 script 都是放在这里的，例如要启动或者关闭 iptables 的话：『 /etc/init.d/iptables start』、『/etc/init.d/iptables stop』<br/>2.`/etc/xinetd.d/`：这就是所谓的super daemon管理的各项服务的配置文件目录。<br/>3.`/etc/X11/`：与 X Window 有关的各种配置文件都在这里，尤其是 xorg.conf 这个 X Server 的配置文件。 |
| /home  | 这是系统默认的用户家目录(home directory)。在你新增一个一般使用者账号时， 默认的用户家目录都会规范到这里来。比较重要的是，家目录有两种代号喔：<br/>~：代表目前这个用户的家目录，而<br/>~dmtsai ：则代表 dmtsai 的家目录！                                                                                                                                                                                                                                                                                                                                                                         |
| /lib   | 系统的函式库非常的多，而/lib放置的则是在开机时会用到的函式库， 以及在/bin或/sbin底下的指令会呼叫的函式库而已。 什么是函式库呢？妳可以将他想成是『外挂』，某些指令必须要有这些『外挂』才能够顺利完成程序的执行之意。 尤其重要的是/lib/modules/这个目录， 因为该目录会放置核心相关的模块(驱动程序)喔！                                                                                                                                                                                                                                                                                                                                         |
| /media | media是『媒体』的英文，顾名思义，这个/media底下放置的就是可移除的装置啦！ 包括软盘、光盘、DVD等等装置都暂时挂载于此。常见的档名有：/media/floppy, /media/cdrom等等。                                                                                                                                                                                                                                                                                                                                                                                                    |
| /mnt   | 如果想要暂时挂载某些额外的装置，一般建议可以放置到这个目录中。 早时候，这个目录的用途与/media相同啦！只是有了/media之后，这个目录就用来暂时挂载用了。                                                                                                                                                                                                                                                                                                                                                                                                                          |
| /opt   | 这个是给第三方协力软件放置的目录。什么是第三方协力软件啊？ 举例来说，KDE这个桌面管理系统是一个独立的计划，不过他可以安装到Linux系统中，因此KDE的软件就建议放置到此目录下了。 另外，如果妳想要自行安装额外的软件(非原本的distribution提供的)，那么也能够将你的软件安装到这里来。 不过，以前的Linux系统中，我们还是习惯放置在/usr/local目录下呢！                                                                                                                                                                                                                                                                                                              |
| /root  | 系统管理员(root)的家目录。之所以放在这里，是因为如果进入单人维护模式而仅挂载根目录时， 该目录就能够拥有root的家目录，所以我们会希望root的家目录与根目录放置在同一个分割槽中。                                                                                                                                                                                                                                                                                                                                                                                                             |
| /sbin  | Linux有非常多指令是用来设定系统环境的，这些指令只有root才能够利用来『设定』系统，其他用户最多只能用来『查询』而已。 放在/sbin底下的为开机过程中所需要的，里面包括了开机、修复、还原系统所需要的指令。 至于某些服务器软件程序，一般则放置到/usr/sbin/当中。至于本机自行安装的软件所产生的系统执行文件(system binary)， 则放置到/usr/local/sbin/当中了。常见的指令包括：fdisk, fsck, ifconfig, init, mkfs等等。                                                                                                                                                                                                                                                       |
| /srv   | srv可以视为『service』的缩写，是一些网络服务启动之后，这些服务所需要取用的数据目录。 常见的服务例如WWW, FTP等等。举例来说，WWW服务器需要的网页数据就可以放置在/srv/www/里面。                                                                                                                                                                                                                                                                                                                                                                                                     |
| /tmp   | 这是让一般使用者或者是正在执行的程序暂时放置文件的地方。 这个目录是任何人都能够存取的，所以你需要定期的清理一下。当然，重要数据不可放置在此目录啊！ 因为FHS甚至建议在开机时，应该要将/tmp下的数据都删除！                                                                                                                                                                                                                                                                                                                                                                                                  |

事实上FHS针对根目录所定义的标准就仅有上面的咚咚，不过我们的Linux底下还有许多目录你也需要了解一下的。 底下是几个在Linux当中也是非常重要的目录：

| 目录          | 应放置文件内容                                                                                                                                                                                                         |
| ----------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| /lost+found | 这个目录是使用标准的ext2/ext3文件系统格式才会产生的一个目录，目的在于当文件系统发生错误时， 将一些遗失的片段放置到这个目录下。这个目录通常会在分割槽的最顶层存在， 例如你加装一颗硬盘于/disk中，那在这个系统下就会自动产生一个这样的目录『/disk/lost+found』                                                                  |
| /proc       | 这个目录本身是一个『虚拟文件系统(virtual filesystem)』喔！他放置的数据都是在内存当中， 例如系统核心、行程信息(process)、周边装置的状态及网络状态等等。因为这个目录下的数据都是在内存当中， 所以本身不占任何硬盘空间啊！比较重要的文件例如：/proc/cpuinfo, /proc/dma, /proc/interrupts, /proc/ioports, /proc/net/* 等等。 |
| /sys        | 这个目录其实跟/proc非常类似，也是一个虚拟的文件系统，主要也是记录与核心相关的信息。 包括目前已加载的核心模块与核心侦测到的硬件装置信息等等。这个目录同样不占硬盘容量喔！                                                                                                                         |

除了这些目录的内容之外，另外要注意的是，因为根目录与开机有关，开机过程中仅有根目录会被挂载， 其他分割槽则是在开机完成之后才会持续的进行挂载的行为。就是因为如此，因此根目录下与开机过程有关的目录， 就不能够与根目录放到不同的分割槽去！那哪些目录不可与根目录分开呢？有底下这些：

- /etc：配置文件
- /bin：重要执行档
- /dev：所需要的装置文件
- /lib：执行档所需的函式库与核心所需的模块
- /sbin：重要的系统执行文件

**这五个目录千万不可与根目录分开在不同的分割槽**！请背下来啊！ 好了，谈完了根目录，接下来我们就来谈谈/usr以及/var！先看/usr里面有些什么东西：

### /usr 的意义与内容

依据FHS的基本定义，/usr里面放置的数据属于可分享的与不可变动的(shareable, static)， 如果你知道如何透过网络进行分割槽的挂载(例如在服务器篇会谈到的[NFS服务器]，那么/usr确实可以分享给局域网络内的其他主机来使用喔！

很多读者都会误会/usr为user的缩写，其实usr是Unix Software Resource的缩写， 也就是『Unix操作系统软件资源』所放置的目录，而不是用户的数据啦！这点要注意。 FHS建议所有软件开发者，应该将他们的数据合理的分别放置到这个目录下的次目录，而不要自行建立该软件自己独立的目录。

因为是所有系统默认的软件(distribution发布者提供的软件)都会放置到/usr底下，因此这个目录有点类似Windows 系统的『C:\Windows\ + C:\Program files\』这两个目录的综合体，系统刚安装完毕时，这个目录会占用最多的硬盘容量。 一般来说，/usr的次目录建议有底下这些：

| 目录                                  | 文件内容                                                                                                                                                                                                             |
| ----------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| /usr/X11R6/                         | 为X Window System重要数据所放置的目录，之所以取名为X11R6是因为最后的X版本为第11版，且该版的第6次释出之意                                                                                                                                                 |
| /usr/bin/                           | 绝大部分的用户可使用指令都放在这里！请注意到他与/bin的不同之处。(是否与开机过程有关)                                                                                                                                                                    |
| /usr/include/                       | c/c++等程序语言的档头(header)与包含档(include)放置处，当我们以tarball方式 (*.tar.gz 的方式安装软件)安装某些数据时，会使用到里头的许多包含档喔！                                                                                                                     |
| /usr/lib/                           | 包含各应用软件的函式库、目标文件(object file)，以及不被一般使用者惯用的执行档或脚本(script)。 某些软件会提供一些特殊的指令来进行服务器的设定，这些指令也不会经常被系统管理员操作， 那就会被摆放到这个目录下啦。要注意的是，如果你使用的是X86_64的Linux系统， 那可能会有/usr/lib64/目录产生喔！                                           |
| /usr/local/                         | 系统管理员在本机自行安装自己下载的软件(非distribution默认提供者)，建议安装到此目录， 这样会比较便于管理。举例来说，你的distribution提供的软件较旧，你想安装较新的软件但又不想移除旧版， 此时你可以将新版软件安装于/usr/local/目录下，可与原先的旧版软件有分别啦！ 你可以自行到/usr/local去看看，该目录下也是具有bin, etc, include, lib...的次目录喔！ |
| /usr/sbin/                          | 非系统正常运作所需要的系统指令。最常见的就是某些网络服务器软件的服务指令(daemon)啰！                                                                                                                                                                   |
| /usr/share/                         | 放置共享文件的地方，在这个目录下放置的数据几乎是不分硬件架构均可读取的数据， 因为几乎都是文本文件嘛！在此目录下常见的还有这些次目录：                                                                                                                                              |
| <br/>/usr/share/man：联机帮助文件          |                                                                                                                                                                                                                  |
| <br/>/usr/share/doc：软件杂项的文件说明       |                                                                                                                                                                                                                  |
| <br/>/usr/share/zoneinfo：与时区有关的时区文件 |                                                                                                                                                                                                                  |
| /usr/src/                           | 一般原始码建议放置到这里，src有source的意思。至于核心原始码则建议放置到/usr/src/linux/目录下。                                                                                                                                                      |

### /var 的意义与内容

如果/usr是安装时会占用较大硬盘容量的目录，那么/var就是在系统运作后才会渐渐占用硬盘容量的目录。 因为/var目录主要针对常态性变动的文件，包括缓存(cache)、登录档(log file)以及某些软件运作所产生的文件， 包括程序文件(lock file, run file)，或者例如MySQL数据库的文件等等。常见的次目录有：

| 目录          | 文件内容                                                                                                                                                                                                                   |
| ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| /var/cache/ | 应用程序本身运作过程中会产生的一些暂存档；                                                                                                                                                                                                  |
| /var/lib/   | 程序本身执行的过程中，需要使用到的数据文件放置的目录。在此目录下各自的软件应该要有各自的目录。 举例来说，MySQL的数据库放置到/var/lib/mysql/而rpm的数据库则放到/var/lib/rpm去！                                                                                                              |
| /var/lock/  | 某些装置或者是文件资源一次只能被一个应用程序所使用，如果同时有两个程序使用该装置时， 就可能产生一些错误的状况，因此就得要将该装置上锁(lock)，以确保该装置只会给单一软件所使用。 举例来说，刻录机正在刻录一块光盘，你想一下，会不会有两个人同时在使用一个刻录机烧片？ 如果两个人同时刻录，那片子写入的是谁的数据？所以当第一个人在刻录时该刻录机就会被上锁， 第二个人就得要该装置被解除锁定(就是前一个人用完了)才能够继续使用啰。 |
| /var/log/   | 重要到不行！这是登录文件放置的目录！里面比较重要的文件如/var/log/messages, /var/log/wtmp(记录登入者的信息)等。                                                                                                                                               |
| /var/mail/  | 放置个人电子邮件信箱的目录，不过这个目录也被放置到/var/spool/mail/目录中！ 通常这两个目录是互为链接文件啦！                                                                                                                                                         |
| /var/run/   | 某些程序或者是服务启动后，会将他们的PID放置在这个目录下喔！ 至于PID的意义我们会在后续章节提到的。                                                                                                                                                                   |
| /var/spool/ | 这个目录通常放置一些队列数据，所谓的『队列』就是排队等待其他程序使用的数据啦！ 这些数据被使用后通常都会被删除。举例来说，系统收到新信会放置到/var/spool/mail/中， 但使用者收下该信件后该封信原则上就会被删除。信件如果暂时寄不出去会被放到/var/spool/mqueue/中， 等到被送出后就被删除。如果是工作排程数据(crontab)，就会被放置到/var/spool/cron/目录中！            |

## 目录树(directory tree)

另外，在Linux底下，所有的文件与目录都是由根目录开始的！那是所有目录与文件的源头～ 然后再一个一个的分支下来，有点像是树枝状啊～因此，我们也称这种目录配置方式为：『目录树(directory tree)』 这个目录树有什么特性呢？他主要的特性有：

- 目录树的启始点为根目录 (/, root)；
- 每一个目录不止能使用本地端的 partition 的文件系统，也可以使用网络上的 filesystem 。举例来说， 可以利用 Network File System (NFS) 服务器挂载某特定目录等。
- 每一个文件在此目录树中的文件名(包含完整路径)都是独一无二的。

好，谈完了FHS的标准之后，实际来看看CentOS在根目录底下会有什么样子的数据吧！我们可以下达以下的指令来查询：

```shell
[root@www ~]# ls -l /
drwxr-xr-x   2 root root  4096 Sep  5 12:34 bin
drwxr-xr-x   4 root root  1024 Sep  4 18:06 boot
drwxr-xr-x  12 root root  4320 Sep 22 12:10 dev
drwxr-xr-x 105 root root 12288 Sep 22 12:10 etc
drwxr-xr-x   4 root root  4096 Sep  5 14:08 home
drwxr-xr-x  14 root root  4096 Sep  5 12:12 lib
drwx------   2 root root 16384 Sep  5 01:49 lost+found
drwxr-xr-x   2 root root  4096 Mar 30  2007 media
drwxr-xr-x   2 root root     0 Sep 22 12:09 misc
drwxr-xr-x   2 root root  4096 Mar 30  2007 mnt
drwxr-xr-x   2 root root     0 Sep 22 12:09 net
drwxr-xr-x   2 root root  4096 Mar 30  2007 opt
dr-xr-xr-x  95 root root     0 Sep 22  2008 proc
drwxr-x---   4 root root  4096 Sep  8 14:06 root
drwxr-xr-x   2 root root 12288 Sep  5 12:33 sbin
drwxr-xr-x   4 root root     0 Sep 22  2008 selinux
drwxr-xr-x   2 root root  4096 Mar 30  2007 srv
drwxr-xr-x  11 root root     0 Sep 22  2008 sys
drwxrwxrwt   6 root root  4096 Sep 22 12:10 tmp
drwxr-xr-x  14 root root  4096 Sep  4 18:00 usr
drwxr-xr-x  26 root root  4096 Sep  4 18:19 var
```

上面表格中比较特殊的应该是/selinux这个目录了，这个目录的内容数据也是在内存中的信息， 同样的不会占用任何的硬盘容量。这个/selinux是Secure Enhance Linux(SELinux)的执行目录， 而SELinux是Linux核心的重要外挂功能之一，他可以用来作为细部权限的控管，主要针对程序(尤其是网络程序)的访问权限来限制。 关于SELinux我们会在后续的章节继续做介绍的喔！

如果我们将整个目录树以图标的方法来显示，并且将较为重要的文件数据列出来的话，那么目录树架构有点像这样：

![](http://cn.linux.vbird.org/linux_basic/0210filepermission_files/directory_tree.gif)

## 绝对路径与相对路径

除了需要特别注意的FHS目录配置外，在文件名部分我们也要特别注意喔！因为根据档名写法的不同，也可将所谓的路径(path)定义为绝对路径(absolute)与相对路径(relative)。 这两种文件名/路径的写法依据是这样的：

- 绝对路径：由根目录(/)开始写起的文件名或目录名称， 例如 /home/dmtsai/.bashrc；
- 相对路径：相对于目前路径的文件名写法。 例如 ./home/dmtsai 或 ../../home/dmtsai/ 等等。反正开头不是 / 就属于相对路径的写法

而你必须要了解，相对路径是以『你当前所在路径的相对位置』来表示的。举例来说，你目前在 /home 这个目录下， 如果想要进入 /var/log 这个目录时，可以怎么写呢？

1. cd /var/log   (absolute)
2. cd ../var/log (relative)

因为你在 /home 底下，所以要回到上一层 (../) 之后，才能继续往 /var 来移动的！ 特别注意这两个特殊的目录：

- .  ：代表当前的目录，也可以使用 ./ 来表示；
- .. ：代表上一层目录，也可以 ../ 来代表。

这个 . 与 .. 目录概念是很重要的，你常常会看到 cd .. 或 ./command 之类的指令下达方式， 就是代表上一层与目前所在目录的工作状态喔！很重要的吶！

> 例题：
> 
> 如何先进入`/var/spool/mail/`目录，再进入到`/var/spool/cron/`目录内？
> 
> 答：
> 
> 由于`/var/spool/mail`与`/var/spool/cron`是同样在`/var/spool/`目录中，因此最简单的指令下达方法为：
> 
> 1. `cd /var/spool/mail`
> 2. `cd ../cron`
> 
> 如此就不需要在由根目录开始写起了。这个相对路径是非常有帮助的！尤其对于某些软件开发商来说。 一般来说，软件开发商会将数据放置到`/usr/local/`里面的各相对目录， 但如果用户想要安装到不同目录呢？就得要使用相对路径啰！^_^
> 
> -----
> 
> 例题：
> 
> 网络文件常常提到类似『./run.sh』之类的数据，这个指令的意义为何？
> 
> 答：
> 
> 由于指令的执行需要变量(bash章节才会提到)的支持，若你的执行文件放置在本目录，并且本目录并非正规的执行文件目录(/bin, /usr/bin等为正规)，此时要执行指令就得要严格指定该执行档。『./』代表『本目录』的意思，所以『./run.sh』代表『执行本目录下， 名为run.sh的文件』啰！

## CentOS 的观察

某些时刻你可能想要知道你的 distribution 使用的是那个 Linux 标准 (Linux Standard Base)， 而且我们也知道 distribution 使用的都是 Linux 的核心！那你如何观察这些基本的信息呢？ 可以使用如下的指令来观察看看啦：

```shell
[root@www ~]# uname -r
2.6.18-128.el5 <==可以察看实际的核心版本
[root@www ~]# lsb_release -a
LSB Version:    :core-3.1-amd64:core-3.1-ia32:core-3.1-noarch:graphics-3.1-amd64:
graphics-3.1-ia32:graphics-3.1-noarch      <==LSB 的版本
Distributor ID: CentOS
Description:    CentOS release 5.3 (Final) <==distribution 的版本
Release:        5.3
Codename:       Final
```

# 